<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loot & Ödül Hesaplayıcı - Nexus Tools</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/style.css">
    <style>
        .nav-tabs .nav-link {
            color: var(--text-muted);
            border: 1px solid transparent;
        }

        .nav-tabs .nav-link.active {
            background-color: var(--bg-secondary);
            color: var(--primary-color);
            border-color: var(--border-color) var(--border-color) var(--bg-secondary);
        }

        .tab-content {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-top: none;
            border-radius: 0 0 8px 8px;
            padding: 20px;
        }

        .player-row {
            background-color: var(--card-bg);
            border-radius: 6px;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .result-card {
            background-color: rgba(0, 0, 0, 0.2);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }

        .highlight-val {
            color: var(--accent-color);
            font-weight: bold;
        }

        .text-azure {
            color: #007fff !important;
        }

        .border-azure {
            border-color: #007fff !important;
        }

        .text-nexus-green {
            color: #009900 !important;
        }

        .border-nexus-green {
            border-color: #009900 !important;
        }
    </style>
</head>

<body class="bg-dark text-light">

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-darker border-bottom border-secondary mb-4">
        <div class="container">
            <a class="navbar-brand" href="../../index.html">
                <i class="fa-solid fa-dungeon me-2"></i>Nexus Tools
            </a>
            <span class="navbar-text ms-auto text-white fw-bold">Loot & Ödül Hesaplayıcı</span>
        </div>
    </nav>

    <div class="container mb-5">

        <!-- Tabs -->
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="endgame-tab" data-bs-toggle="tab" data-bs-target="#endgame"
                    type="button" role="tab">
                    <i class="fa-solid fa-trophy me-2"></i>Campaign Sonu Ödülleri Hesaplayıcı
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="planner-tab" data-bs-toggle="tab" data-bs-target="#planner" type="button"
                    role="tab">
                    <i class="fa-solid fa-sack-dollar me-2"></i>Campaign Max GP Hesaplayıcı
                </button>
            </li>
        </ul>

        <div class="tab-content" id="myTabContent">

            <!-- Tab 1: End Game Calculator -->
            <div class="tab-pane fade show active" id="endgame" role="tabpanel">
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label class="form-label">Oyun Süresi</label>
                        <div class="input-group">
                            <input type="number" class="form-control" id="gameHours" placeholder="Saat" min="0" max="96">
                            <span class="input-group-text">Sa</span>
                            <input type="number" class="form-control" id="gameMinutes" placeholder="Dk" min="0"
                                max="59">
                            <span class="input-group-text">Dk</span>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label">Bulunan Toplam Loot (GP)</label>
                        <input type="number" class="form-control" id="totalLoot" placeholder="Örn: 5000" min="0">
                    </div>
                    <div class="col-md-4 mb-3 d-flex align-items-center gap-2" style="padding-top: 2rem;">
                        <input type="checkbox" class="form-check-input m-0" id="vipDM">
                        <label class="form-label mb-0" for="vipDM">VIP DM</label>
                    </div>
                </div>

                <div class="d-flex justify-content-between align-items-center mb-2">
                    <label class="form-label mb-0">Avatarlar</label>
                    <button class="btn btn-sm btn-outline-success" onclick="addPlayerRow('endgame')">
                        <i class="fa-solid fa-plus me-1"></i>Avatar Ekle
                    </button>
                </div>
                <div id="endgame-players">
                    <!-- Dynamic Rows -->
                </div>

                <div class="d-grid mb-4">
                    <button class="btn btn-primary" onclick="calculateEndGame()">
                        Hesapla
                    </button>
                </div>

                <!-- Warnings -->
                <div id="minHoursWarning" class="alert alert-danger d-flex align-items-center mt-4 mb-0 d-none"
                    role="alert">
                    <i class="fa-solid fa-clock fa-2x me-3"></i>
                    <div>
                        <strong>SÜRE YETERSİZ!</strong><br>
                        Oyun süresi minimum 3 saat olmalıdır. Lütfen süreyi kontrol ediniz.
                    </div>
                </div>

                <div id="lootCapWarning" class="alert alert-warning d-flex align-items-center mt-4 mb-0 d-none"
                    role="alert">
                    <i class="fa-solid fa-triangle-exclamation fa-2x me-3"></i>
                    <div>
                        <strong>DİKKAT!</strong><br>
                        Campaign altın ödülünüz maksimum miktarı aşmıştır. Lütfen "Bulunan Toplam Loot (GP)"
                        verisini doğru girin. Bulunan Toplam Loot (GP) miktarı maksimum <span id="warnCapAmount"
                            class="fw-bold"></span> olabilir.
                    </div>
                </div>

                <!-- End Game Results -->
                <div id="endgame-result" class="d-none">
                    <div class="result-card border-azure">
                        <h5 class="border-bottom pb-2 mb-3 text-azure border-azure">Genel Özet</h5>
                        <div class="row text-center">
                            <div class="col-6 col-md-3 mb-2">
                                <small class="text-white d-block">Süre</small>
                                <span class="fw-bold text-azure" id="resDuration">-</span>
                            </div>
                            <div class="col-6 col-md-3 mb-2">
                                <small class="text-white d-block">Max Milestone</small>
                                <span class="fw-bold text-azure" id="resMaxMS">-</span>
                            </div>
                            <div class="col-6 col-md-3 mb-2">
                                <small class="text-white d-block">DM Puan Ortalaması</small>
                                <span class="fw-bold text-azure" id="resDMAvg">-</span>
                            </div>
                            <div class="col-6 col-md-3 mb-2">
                                <small class="text-white d-block">Bulunan Loot Oranı</small>
                                <span class="fw-bold text-azure" id="resPerf">-</span>
                            </div>
                        </div>
                    </div>

                    <div class="result-card border-nexus-green">
                        <h5 class="border-bottom pb-2 mb-3 text-nexus-green border-nexus-green">Oyuncu Sonuçları</h5>
                        <ul class="list-group list-group-flush bg-transparent" id="resPlayerList">
                            <!-- JS Generated -->
                        </ul>
                        <div class="mt-2 px-3 text-end">
                            <small class="d-block text-white-50" style="font-size: 0.75rem;"><span
                                    class="text-info fw-bold">MS:</span> Milestone</small>
                            <small class="d-block text-white-50" style="font-size: 0.75rem;"><span
                                    class="text-success fw-bold">GT:</span> Genesis Token</small>
                        </div>
                    </div>

                    <div class="result-card border-warning">
                        <h5 class="border-bottom pb-2 mb-3 text-warning border-warning">DM Ödülleri</h5>
                        <div class="row text-center">
                            <div class="col-4">
                                <small class="text-white d-block">Altın</small>
                                <span class="highlight-val text-warning" id="resDMGold">-</span>
                            </div>
                            <div class="col-4">
                                <small class="text-white d-block">Milestone</small>
                                <span class="highlight-val text-warning" id="resDMMS">-</span>
                            </div>
                            <div class="col-4">
                                <small class="text-white d-block">Genesis Token</small>
                                <span class="highlight-val text-warning" id="resDMGenesis">-</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab 2: Loot Planner -->
            <div class="tab-pane fade" id="planner" role="tabpanel">

                <div class="mb-3">
                    <label class="form-label">Planlanan Süre (Saat)</label>
                    <input type="number" class="form-control" id="planHours"
                        placeholder="Campaign'in sürmesini planladığınız maksimum süreyi girin. Örn: 20" min="3">
                </div>

                <div class="mb-3">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <label class="form-label mb-0">Avatarlar</label>
                        <button class="btn btn-sm btn-outline-success" onclick="addPlayerRow('planner')">
                            <i class="fa-solid fa-plus me-1"></i>Avatar Ekle
                        </button>
                    </div>
                    <div id="planner-players">
                        <!-- Dynamic Rows -->
                    </div>
                </div>

                <div class="d-grid mb-4">
                    <button class="btn btn-primary" onclick="calculatePlanner()">
                        <i class="fa-solid fa-coins me-2"></i>Loot Hesapla
                    </button>
                </div>

                <!-- Planner Results -->
                <div id="planner-result" class="d-none">
                    <div class="result-card text-center">
                        <h4 class="mb-3">Campaign'e serpiştirmeniz gereken toplam loot değeri:</h4>
                        <div class="display-4 highlight-val mb-3" id="resPlannedLoot">0 GP</div>

                        <div class="alert alert-warning text-start small mt-4">
                            <strong>NOT:</strong> Campaign sonunda toplam altın ödülüne dahil edilmesini istediğiniz
                            loot'ların yanına parantez içinde GP değerlerini yazmayı (Örn: "Diamonda (300 GP)") ihmal
                            etmeyin.
                        </div>
                        <div class="alert alert-secondary text-start small">
                            <strong>NOT:</strong> Campaign'de elde edilebilecek bütün loot'ları toplam altın ödülüne
                            dahil etmek zorunda değilsiniz. Örneğin, campaign'de kullanılması gereken bir magic item var
                            ama campaign sonu toplam altın ödülüne dahil etmek istemiyorsunuz diyelim. Bu durumda, bu
                            item'ı toplam altın ödülüne dahil etmeyin (evet, bu kadar basit). Oyunculara bu item'ı
                            verirken ismine GP değerini yazmayın. Bu sayede bu item'ın toplam altın ödülüne dahil
                            olmadığını belirtmiş olursunuz.
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Templates for Dynamic Rows (Hidden) -->
    <template id="tpl-endgame-row">
        <div class="player-row">
            <div class="flex-grow-1">
                <label class="small text-white">Seviye</label>
                <input type="number" class="form-control form-control-sm inp-level" min="1" max="20" placeholder="Lvl"
                    required>
            </div>
            <div class="flex-grow-1">
                <label class="small text-white">DM Puanı</label>
                <input type="number" class="form-control form-control-sm inp-points" min="1" max="5" placeholder="1-5"
                    required>
            </div>
            <div class="d-flex align-items-center ms-3" style="padding-top: 1.4rem;">
                <input type="checkbox" class="form-check-input inp-vip m-0 me-2">
                <label class="small text-white mb-0" style="white-space: nowrap;">VIP Avatar</label>
            </div>
            <button class="btn btn-sm btn-outline-danger mt-3" onclick="this.parentElement.remove()">
                <i class="fa-solid fa-trash"></i>
            </button>
        </div>
    </template>

    <template id="tpl-planner-row">
        <div class="player-row">
            <div class="flex-grow-1">
                <label class="small text-white">Level</label>
                <input type="number" class="form-control form-control-sm inp-level" min="1" max="20" placeholder="Lvl"
                    required>
            </div>
            <button class="btn btn-sm btn-outline-danger mt-3" onclick="this.parentElement.remove()">
                <i class="fa-solid fa-trash"></i>
            </button>
        </div>
    </template>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
</body>

</html>